<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile Touchpad Controller</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #f0f0f0;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .title {
            font-size: 2.5em;
            color: #333;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2em;
            color: #666;
        }
        
        .instructions {
            background: #fff;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .bookmarklet {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            padding: 12px 25px;
            text-decoration: none;
            border-radius: 8px;
            display: inline-block;
            margin: 15px 0;
            font-weight: 600;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,123,255,0.3);
        }
        
        .bookmarklet:hover {
            background: linear-gradient(135deg, #0056b3, #004085);
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,123,255,0.4);
        }
        
        .status {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #007bff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .status h3 {
            color: #333;
            margin-bottom: 10px;
        }
        
        #debug {
            font-family: 'SF Mono', Monaco, monospace;
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            margin-top: 10px;
            border: 1px solid #e9ecef;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .feature-card {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .feature-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .feature-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }
        
        .feature-desc {
            color: #666;
            font-size: 14px;
        }
        
        .info-box {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border: 1px solid #90caf9;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .info-box strong {
            color: #1565c0;
        }
        
        .mobile-url {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 16px;
            color: #495057;
            border: 1px solid #dee2e6;
            margin: 10px 0;
        }
        
        .steps {
            counter-reset: step-counter;
        }
        
        .steps li {
            counter-increment: step-counter;
            margin-bottom: 15px;
            padding-left: 10px;
        }
        
        .steps li::marker {
            content: counter(step-counter) ". ";
            font-weight: bold;
            color: #007bff;
        }
        
        ul ul {
            margin-top: 8px;
        }
        
        ul ul li {
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="title">üì± Mobile Touchpad Controller</div>
            <div class="subtitle">Turn your phone into a wireless touchpad</div>
        </div>
        
        <div class="feature-grid">
            <div class="feature-card">
                <div class="feature-icon">üñ±Ô∏è</div>
                <div class="feature-title">Wireless Touchpad</div>
                <div class="feature-desc">Use your phone screen as a laptop touchpad</div>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üìú</div>
                <div class="feature-title">Scroll Control</div>
                <div class="feature-desc">Dedicated joystick for smooth scrolling</div>
            </div>
            <div class="feature-card">
                <div class="feature-icon">‚öôÔ∏è</div>
                <div class="feature-title">Customizable</div>
                <div class="feature-desc">Adjust sensitivity and layout size</div>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üåê</div>
                <div class="feature-title">Universal</div>
                <div class="feature-desc">Works on any website or application</div>
            </div>
        </div>
        
        <div class="instructions">
            <h2>üöÄ Quick Setup</h2>
            <ol class="steps">
                <li><strong>Drag this bookmarklet to your bookmarks bar:</strong></li>
                <a href="javascript:(function(){if(window.mobileTouchpad){return;}window.mobileTouchpad=true;const ws=new WebSocket('ws://localhost:3000/?role=desktop');let mouseX=window.innerWidth/2,mouseY=window.innerHeight/2;function updateCursor(){const cursor=document.getElementById('mobileCursor');if(cursor){cursor.style.left=(mouseX-5)+'px';cursor.style.top=(mouseY-5)+'px';}}function simulateClick(button,action){const eventType=action==='down'?'mousedown':action==='up'?'mouseup':'click';const event=new MouseEvent(eventType,{button:button==='left'?0:2,clientX:mouseX,clientY:mouseY,bubbles:true,cancelable:true});document.elementFromPoint(mouseX,mouseY)?.dispatchEvent(event)||document.dispatchEvent(event);}function moveMouseCursor(deltaX,deltaY){mouseX=Math.max(10,Math.min(window.innerWidth-10,mouseX+deltaX*3));mouseY=Math.max(10,Math.min(window.innerHeight-10,mouseY+deltaY*3));updateCursor();const event=new MouseEvent('mousemove',{clientX:mouseX,clientY:mouseY,bubbles:true});document.dispatchEvent(event);}function scrollPage(deltaY){window.scrollBy({top:deltaY*20,behavior:'smooth'});}ws.onmessage=(e)=>{const d=JSON.parse(e.data);if(d.type==='joystick'){if(Math.abs(d.y)>0.1){scrollPage(d.y);}}else if(d.type==='mouseMove'){moveMouseCursor(d.x,d.y);}else if(d.type==='click'){simulateClick(d.button,d.action);}};const indicator=document.createElement('div');indicator.style.cssText='position:fixed;top:10px;right:10px;background:blue;color:white;padding:5px 10px;border-radius:5px;z-index:9999;font-size:12px;';indicator.textContent='üì± Mobile Touchpad Active';document.body.appendChild(indicator);const cursor=document.createElement('div');cursor.id='mobileCursor';cursor.style.cssText='position:fixed;width:12px;height:12px;background:red;border:2px solid white;border-radius:50%;pointer-events:none;z-index:9998;box-shadow:0 0 10px rgba(0,0,0,0.5);';document.body.appendChild(cursor);updateCursor();})();" class="bookmarklet">üì± Mobile Touchpad</a>
                
                <li><strong>Go to any website</strong> (YouTube, Google, social media, etc.)</li>
                <li><strong>Click the bookmarklet</strong> - you'll see "üì± Mobile Touchpad Active" and a red cursor</li>
                <li><strong>Open mobile controller on your phone</strong> (see URL below)</li>
                <li><strong>Start controlling!</strong>
                    <ul>
                        <li><strong>Left joystick:</strong> Scroll pages up/down</li>
                        <li><strong>Right touchpad:</strong> Move cursor, tap to click</li>
                        <li><strong>Settings (‚öô):</strong> Adjust sensitivity and layout</li>
                    </ul>
                </li>
            </ol>
        </div>
        
        <div class="status">
            <h3>üì° Connection Status</h3>
            <div id="debug">Waiting for mobile connection...</div>
        </div>
        
        <div class="instructions">
            <h3>üì± Mobile Controller URL</h3>
            <p>Open this URL on your phone:</p>
            <div class="mobile-url" id="mobileUrl">http://YOUR-IP:3000/mobile</div>
            <p><a href="/mobile" target="_blank">Or click here if on the same device</a></p>
        </div>
        
        <div class="info-box">
            <strong>üí° How it works:</strong> Your phone becomes a wireless touchpad for your laptop! The red cursor shows where your "mouse" is, and you can click on anything just like a real touchpad. Use the joystick to scroll pages while controlling the cursor simultaneously.
        </div>
    </div>

    <script>
        // Get local IP and update mobile URL
        function updateMobileUrl() {
            const mobileUrl = document.getElementById('mobileUrl');
            const host = window.location.hostname;
            if (host === 'localhost' || host === '127.0.0.1') {
                mobileUrl.textContent = 'http://YOUR-LOCAL-IP:3000/mobile';
                mobileUrl.innerHTML += '<br><small style="color: #666;">Replace YOUR-LOCAL-IP with your computer\'s IP address</small>';
            } else {
                mobileUrl.textContent = `http://${host}:3000/mobile`;
            }
        }
        
        updateMobileUrl();
        
        // Test connection
        const debug = document.getElementById('debug');
        const ws = new WebSocket(`ws://${location.host}/?role=desktop`);
        
        ws.onopen = () => {
            debug.textContent = '‚úÖ Server connected! Ready for mobile controller.';
            debug.style.color = '#28a745';
        };
        
        ws.onmessage = (event) => {
            const data = JSON.parse(event.data);
            if (data.type === 'mouseMove') {
                debug.textContent = `üì± Cursor: x=${data.x.toFixed(1)}, y=${data.y.toFixed(1)}`;
            } else if (data.type === 'joystick') {
                debug.textContent = `üïπÔ∏è Scroll: x=${data.x.toFixed(1)}, y=${data.y.toFixed(1)}`;
            } else if (data.type === 'click') {
                debug.textContent = `üëÜ Click: ${data.button} ${data.action}`;
            }
            debug.style.color = '#007bff';
        };
        
        ws.onclose = () => {
            debug.textContent = '‚ùå Server disconnected. Refresh page to reconnect.';
            debug.style.color = '#dc3545';
        };
        
        ws.onerror = () => {
            debug.textContent = '‚ö†Ô∏è Connection error. Make sure server is running.';
            debug.style.color = '#ffc107';
        };
    </script>
</body>
</html>